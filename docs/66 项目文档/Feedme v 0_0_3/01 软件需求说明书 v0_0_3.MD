# 软件需求说明书 Feedme v 0.0.2

## 版本概述

版本 Feedme v 0.0.2，新增需求：

- 数据下载GUI程序；
  - 交易日历下载；
  - 每日增量数据下载;
  - About关于界面

- Tushare股票日K线历史存量数据下载
- 开发基于本地Tushare数据库股票日线数据的bt.DataFeed

## 需求清单

| 大类 | 功能 | 说明 |
| -- | -- | -- |
| 数据下载GUI程序 | 交易日历下载 |  |
|  | 每日增量数据下载 |  |
| | About关于界面 |  |
| 存量数据下载 | Tushare股票日K线历史存量数据下载 |  |
|  | Tushare交易日历数据下载 |  |
| bt.DataFeed | 开发基于本地Tushare数据库股票日线数据的bt.DataFeed |      |
|  | 关于如何构建DataFeed的文档 | 文档 |

## 1. 数据下载GUI程序

需要实现功能：

- 使用Tkinter构建一个GUI界面程序，其主界面如下图：

![image-20221129135755497](01 软件需求说明书 v0_0_2.assets/image-20221129135755497.png)

界面要求：

- 有操作菜单，菜单见下：
- 主界面左侧为系统主要参数List，列出有最新系统情况；
  - 最新数据日期（为Tushare股票日线的最新日期）
  - 最早数据日期（为Tushare股票日线的最早日期）
  - 交易日历，为交易日历的起止日期。
- 主界面右侧为刷新按钮。点击后刷新左侧系统参数。

#### 菜单

系统菜单布局如下：

- 下载
  - 下载今日数据
  - 存量下载
    - Tushare 股票日线数据
  - 下载交易日历
- About

界面如下图：

![image-20221129140617790](01 软件需求说明书 v0_0_2.assets/image-20221129140617790.png)





### 1.1 交易日历下载

点击主界面菜单“下载->下载交易日历”打开新窗口。

界面如下：

![image-20221129140814630](01 软件需求说明书 v0_0_2.assets/image-20221129140814630.png)

主要功能：

- 左侧为内容输出栏
- 默认输出内容包括当前交易日历的开始、结束日期，交易所信息；
- 右侧”重新下载”按钮，点击后下载全部交易所的全量交易日历；
- 右侧“查看现状”按钮，点击后左侧的输出栏重新输出交易日历内容。

### 1.2 每日增量数据下载

点击主界面菜单“下载->下载今日数据”打开新窗口。

界面如下：

![image-20221129141059775](01 软件需求说明书 v0_0_2.assets/image-20221129141059775.png)

主要功能：

- 系统日期栏，显示当前系统日期；
- 数据日期栏默认现实数据日期，用户可修改。输入内容必须符合yyyyMMdd格式。
- 点击下载则根据数据日期内容作为参数实施下载。
  - 下载内容包括：Tushare股票清单、Tushare股票日线
  - 下载后内容输出到日志栏；
  - 如果日期为非交易日，则下载中止，日志栏输出情况；
  - 如果当日日线数据尚未提供，则下载终止，日志栏输出情况；
  - 下载过程中“下载”按钮置为Disabled，下载结束后恢复;
  - 如果当日已有数据，则弹出确认窗口，用户确认后覆盖更新，否则下载终止；
  - 完成每一项数据下载，在日志栏中输出。

### 1.3 About关于界面

点击主界面菜单“About”打开新窗口。

界面如下：

![image-20221129141927895](01 软件需求说明书 v0_0_2.assets/image-20221129141927895.png)

主要功能：

- 显示当前版本，其内容从配置文件中读取；
- 显示数据库配置文件地址，其内容从配置文件中读取sqlite3.db.path。

## 2. 存量数据下载

需要实现功能：

- Tushare股票存量数据下载

### 2.1 Tushare股票存量数据下载

点击主界面菜单“下载->存量下载->Tushare A股票日线数据”打开新窗口。

界面如下：

![image-20221129143709009](01 软件需求说明书 v0_0_2.assets/image-20221129143709009.png)

主要功能：

- 右侧为内容输出栏
- 点击“存量数据下载”按钮后下载；
  - 如果库中已有数据，则弹出窗口供用户确认；
  - 每个股票下载后，则输出到右侧菜单中。

## 3. bt.DataFeed

需要实现功能：

- 使用下载本地的数据，构建回测用的bt.DataFeed对象
- 关于如何构建DataFeed的文档

### 3.1 回测用的bt.DataFeed对象

需要实现的功能：

- get_astock_daily_kbar 函数
- 提供日期范围参数
- 支持多个股票（逐一adddata）

### 3.2 关于如何构建DataFeed的文档

需要实现的功能：

- 形成可独立学习的文档
- 基于csv文件的Datafeed，要说明参数、列参数、日期格式等的使用方式
- 基于csv文件加自定义列的情况，列格式只能为float
- 基于pd.Dataframe的Datafeed，其中index必须是日期格式
- 从数据库中读取内容，形成Datafeed

END
